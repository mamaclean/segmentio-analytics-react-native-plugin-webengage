{"version":3,"names":["WebEngagePlugin","DestinationPlugin","PluginType","destination","webEngage","undefined","settings","update","_","webEngageSettings","integrations","key","WebEngage","identify","event","isInitialized","userId","login","track","eventName","properties","screen","name","reset","logout"],"sources":["WebEngagePlugin.tsx"],"sourcesContent":["import {\n  DestinationPlugin,\n  IdentifyEventType,\n  PluginType,\n  ScreenEventType,\n  TrackEventType,\n  SegmentAPISettings,\n  UpdateType,\n  JsonMap,\n} from \"@segment/analytics-react-native\";\nimport type { SegmentWebEngageSettings } from './types';\nimport WebEngage from \"react-native-webengage\";\n\nexport class WebEngagePlugin extends DestinationPlugin {\n  type = PluginType.destination;\n  key = 'WebEngage';\n\n  private webEngage: WebEngage | undefined;\n  private settings: SegmentWebEngageSettings | undefined;\n  private isInitialized = () =>\n      this.webEngage !== undefined && this.settings !== undefined;\n\n  update(settings: SegmentAPISettings, _: UpdateType) {\n    const webEngageSettings = settings.integrations[\n        this.key\n        ] as SegmentWebEngageSettings;\n\n    if (webEngageSettings === undefined || this.webEngage !== undefined) {\n      return;\n    }\n    this.webEngage = new WebEngage();\n    this.settings = webEngageSettings;\n  }\n\n  identify(event: IdentifyEventType) {\n    if (this.isInitialized()) {\n      const userId = event.userId;\n      this.webEngage?.login(userId)\n    }\n    return event;\n  }\n\n  track(event: TrackEventType) {\n    const eventName = event.event;\n    const properties = event.properties as JsonMap;\n\n    if (this.isInitialized()) {\n      this.webEngage?.track(eventName, properties)\n    }\n    return event;\n  }\n\n  screen(event: ScreenEventType) {\n    if (this.isInitialized()) {\n      const name = event.name;\n      const properties = event.properties;\n      this.webEngage?.screen(name, properties)\n    }\n    return event;\n  }\n\n  reset(): void {\n    this.webEngage?.logout();\n  }\n}\n"],"mappings":";;;;;;;AAAA;;AAWA;;;;;;AAEO,MAAMA,eAAN,SAA8BC,uCAA9B,CAAgD;EAAA;IAAA;;IAAA,8BAC9CC,gCAAA,CAAWC,WADmC;;IAAA,6BAE/C,WAF+C;;IAAA;;IAAA;;IAAA,uCAM7B,MACpB,KAAKC,SAAL,KAAmBC,SAAnB,IAAgC,KAAKC,QAAL,KAAkBD,SAPD;EAAA;;EASrDE,MAAM,CAACD,QAAD,EAA+BE,CAA/B,EAA8C;IAClD,MAAMC,iBAAiB,GAAGH,QAAQ,CAACI,YAAT,CACtB,KAAKC,GADiB,CAA1B;;IAIA,IAAIF,iBAAiB,KAAKJ,SAAtB,IAAmC,KAAKD,SAAL,KAAmBC,SAA1D,EAAqE;MACnE;IACD;;IACD,KAAKD,SAAL,GAAiB,IAAIQ,6BAAJ,EAAjB;IACA,KAAKN,QAAL,GAAgBG,iBAAhB;EACD;;EAEDI,QAAQ,CAACC,KAAD,EAA2B;IACjC,IAAI,KAAKC,aAAL,EAAJ,EAA0B;MAAA;;MACxB,MAAMC,MAAM,GAAGF,KAAK,CAACE,MAArB;MACA,wBAAKZ,SAAL,oEAAgBa,KAAhB,CAAsBD,MAAtB;IACD;;IACD,OAAOF,KAAP;EACD;;EAEDI,KAAK,CAACJ,KAAD,EAAwB;IAC3B,MAAMK,SAAS,GAAGL,KAAK,CAACA,KAAxB;IACA,MAAMM,UAAU,GAAGN,KAAK,CAACM,UAAzB;;IAEA,IAAI,KAAKL,aAAL,EAAJ,EAA0B;MAAA;;MACxB,yBAAKX,SAAL,sEAAgBc,KAAhB,CAAsBC,SAAtB,EAAiCC,UAAjC;IACD;;IACD,OAAON,KAAP;EACD;;EAEDO,MAAM,CAACP,KAAD,EAAyB;IAC7B,IAAI,KAAKC,aAAL,EAAJ,EAA0B;MAAA;;MACxB,MAAMO,IAAI,GAAGR,KAAK,CAACQ,IAAnB;MACA,MAAMF,UAAU,GAAGN,KAAK,CAACM,UAAzB;MACA,yBAAKhB,SAAL,sEAAgBiB,MAAhB,CAAuBC,IAAvB,EAA6BF,UAA7B;IACD;;IACD,OAAON,KAAP;EACD;;EAEDS,KAAK,GAAS;IAAA;;IACZ,yBAAKnB,SAAL,sEAAgBoB,MAAhB;EACD;;AAlDoD"}