{"version":3,"names":["DestinationPlugin","PluginType","WebEngage","WebEngagePlugin","destination","webEngage","undefined","settings","update","_","webEngageSettings","integrations","key","identify","event","isInitialized","userId","user","login","track","eventName","properties","screen","name","reset","logout"],"sources":["WebEngagePlugin.tsx"],"sourcesContent":["import {\n  DestinationPlugin,\n  IdentifyEventType,\n  PluginType,\n  ScreenEventType,\n  TrackEventType,\n  SegmentAPISettings,\n  UpdateType,\n  JsonMap,\n} from \"@segment/analytics-react-native\";\nimport type { SegmentWebEngageSettings } from './types';\nimport WebEngage from \"react-native-webengage\";\n\nexport class WebEngagePlugin extends DestinationPlugin {\n  type = PluginType.destination;\n  key = 'WebEngage';\n\n  private webEngage: WebEngage | undefined;\n  private settings: SegmentWebEngageSettings | undefined;\n  private isInitialized = () =>\n      this.webEngage !== undefined && this.settings !== undefined;\n\n  update(settings: SegmentAPISettings, _: UpdateType) {\n    const webEngageSettings = settings.integrations[\n        this.key\n        ] as SegmentWebEngageSettings;\n\n    if (webEngageSettings === undefined || this.webEngage !== undefined) {\n      return;\n    }\n    this.webEngage = new WebEngage();\n    this.settings = webEngageSettings;\n  }\n\n  identify(event: IdentifyEventType) {\n    if (this.isInitialized()) {\n      const userId = event.userId;\n      this.webEngage?.user.login(userId)\n    }\n    return event;\n  }\n\n  track(event: TrackEventType) {\n    const eventName = event.event;\n    const properties = event.properties as JsonMap;\n\n    if (this.isInitialized()) {\n      this.webEngage?.track(eventName, properties)\n    }\n    return event;\n  }\n\n  screen(event: ScreenEventType) {\n    if (this.isInitialized()) {\n      const name = event.name;\n      const properties = event.properties;\n      this.webEngage?.screen(name, properties)\n    }\n    return event;\n  }\n\n  reset(): void {\n    this.webEngage?.user.logout();\n  }\n}\n"],"mappings":";;AAAA,SACEA,iBADF,EAGEC,UAHF,QASO,iCATP;AAWA,OAAOC,SAAP,MAAsB,wBAAtB;AAEA,OAAO,MAAMC,eAAN,SAA8BH,iBAA9B,CAAgD;EAAA;IAAA;;IAAA,8BAC9CC,UAAU,CAACG,WADmC;;IAAA,6BAE/C,WAF+C;;IAAA;;IAAA;;IAAA,uCAM7B,MACpB,KAAKC,SAAL,KAAmBC,SAAnB,IAAgC,KAAKC,QAAL,KAAkBD,SAPD;EAAA;;EASrDE,MAAM,CAACD,QAAD,EAA+BE,CAA/B,EAA8C;IAClD,MAAMC,iBAAiB,GAAGH,QAAQ,CAACI,YAAT,CACtB,KAAKC,GADiB,CAA1B;;IAIA,IAAIF,iBAAiB,KAAKJ,SAAtB,IAAmC,KAAKD,SAAL,KAAmBC,SAA1D,EAAqE;MACnE;IACD;;IACD,KAAKD,SAAL,GAAiB,IAAIH,SAAJ,EAAjB;IACA,KAAKK,QAAL,GAAgBG,iBAAhB;EACD;;EAEDG,QAAQ,CAACC,KAAD,EAA2B;IACjC,IAAI,KAAKC,aAAL,EAAJ,EAA0B;MAAA;;MACxB,MAAMC,MAAM,GAAGF,KAAK,CAACE,MAArB;MACA,wBAAKX,SAAL,oEAAgBY,IAAhB,CAAqBC,KAArB,CAA2BF,MAA3B;IACD;;IACD,OAAOF,KAAP;EACD;;EAEDK,KAAK,CAACL,KAAD,EAAwB;IAC3B,MAAMM,SAAS,GAAGN,KAAK,CAACA,KAAxB;IACA,MAAMO,UAAU,GAAGP,KAAK,CAACO,UAAzB;;IAEA,IAAI,KAAKN,aAAL,EAAJ,EAA0B;MAAA;;MACxB,yBAAKV,SAAL,sEAAgBc,KAAhB,CAAsBC,SAAtB,EAAiCC,UAAjC;IACD;;IACD,OAAOP,KAAP;EACD;;EAEDQ,MAAM,CAACR,KAAD,EAAyB;IAC7B,IAAI,KAAKC,aAAL,EAAJ,EAA0B;MAAA;;MACxB,MAAMQ,IAAI,GAAGT,KAAK,CAACS,IAAnB;MACA,MAAMF,UAAU,GAAGP,KAAK,CAACO,UAAzB;MACA,yBAAKhB,SAAL,sEAAgBiB,MAAhB,CAAuBC,IAAvB,EAA6BF,UAA7B;IACD;;IACD,OAAOP,KAAP;EACD;;EAEDU,KAAK,GAAS;IAAA;;IACZ,yBAAKnB,SAAL,sEAAgBY,IAAhB,CAAqBQ,MAArB;EACD;;AAlDoD"}