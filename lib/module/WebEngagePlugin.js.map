{"version":3,"names":["DestinationPlugin","PluginType","WebEngage","WebEngagePlugin","destination","webEngage","undefined","settings","update","_","webEngageSettings","integrations","key","identify","event","console","log","isInitialized","userId","user","login","track","eventName","properties","screen","name","reset","logout"],"sources":["WebEngagePlugin.tsx"],"sourcesContent":["import {\n  DestinationPlugin,\n  IdentifyEventType,\n  PluginType,\n  ScreenEventType,\n  TrackEventType,\n  SegmentAPISettings,\n  UpdateType,\n  JsonMap,\n} from \"@segment/analytics-react-native\";\nimport type { SegmentWebEngageSettings } from './types';\nimport WebEngage from \"react-native-webengage\";\n\nexport class WebEngagePlugin extends DestinationPlugin {\n  type = PluginType.destination;\n  key = 'WebEngage';\n\n  private webEngage: WebEngage | undefined;\n  private settings: SegmentWebEngageSettings | undefined;\n  private isInitialized = () =>\n      this.webEngage !== undefined && this.settings !== undefined;\n\n  update(settings: SegmentAPISettings, _: UpdateType) {\n    const webEngageSettings = settings.integrations[\n        this.key\n        ] as SegmentWebEngageSettings;\n\n    if (webEngageSettings === undefined || this.webEngage !== undefined) {\n      return;\n    }\n    this.webEngage = new WebEngage();\n    this.settings = webEngageSettings;\n  }\n\n  identify(event: IdentifyEventType) {\n    console.log(\"WebEngage login - pre check\");\n    if (this.isInitialized()) {\n      const userId = event.userId;\n      console.log(\"WebEngage login\");\n      this.webEngage.user.login(userId)\n    }\n    return event;\n  }\n\n  track(event: TrackEventType) {\n    console.log(\"WebEngage track - pre check\");\n    const eventName = event.event;\n    const properties = event.properties as JsonMap;\n\n    if (this.isInitialized()) {\n      console.log(\"WebEngage track\");\n      this.webEngage.track(eventName, properties);\n    }\n    return event;\n  }\n\n  screen(event: ScreenEventType) {\n    console.log(\"WebEngage screen - pre check\");\n    if (this.isInitialized()) {\n      console.log(\"WebEngage screen\");\n      const name = event.name;\n      const properties = event.properties;\n      this.webEngage.screen(name, properties)\n    }\n    return event;\n  }\n\n  reset(): void {\n    console.log(\"WebEngage reset - pre check\");\n    if (this.isInitialized()) {\n      console.log(\"WebEngage reset\");\n      this.webEngage.user.logout();\n    }\n  }\n}\n"],"mappings":";;AAAA,SACEA,iBADF,EAGEC,UAHF,QASO,iCATP;AAWA,OAAOC,SAAP,MAAsB,wBAAtB;AAEA,OAAO,MAAMC,eAAN,SAA8BH,iBAA9B,CAAgD;EAAA;IAAA;;IAAA,8BAC9CC,UAAU,CAACG,WADmC;;IAAA,6BAE/C,WAF+C;;IAAA;;IAAA;;IAAA,uCAM7B,MACpB,KAAKC,SAAL,KAAmBC,SAAnB,IAAgC,KAAKC,QAAL,KAAkBD,SAPD;EAAA;;EASrDE,MAAM,CAACD,QAAD,EAA+BE,CAA/B,EAA8C;IAClD,MAAMC,iBAAiB,GAAGH,QAAQ,CAACI,YAAT,CACtB,KAAKC,GADiB,CAA1B;;IAIA,IAAIF,iBAAiB,KAAKJ,SAAtB,IAAmC,KAAKD,SAAL,KAAmBC,SAA1D,EAAqE;MACnE;IACD;;IACD,KAAKD,SAAL,GAAiB,IAAIH,SAAJ,EAAjB;IACA,KAAKK,QAAL,GAAgBG,iBAAhB;EACD;;EAEDG,QAAQ,CAACC,KAAD,EAA2B;IACjCC,OAAO,CAACC,GAAR,CAAY,6BAAZ;;IACA,IAAI,KAAKC,aAAL,EAAJ,EAA0B;MACxB,MAAMC,MAAM,GAAGJ,KAAK,CAACI,MAArB;MACAH,OAAO,CAACC,GAAR,CAAY,iBAAZ;MACA,KAAKX,SAAL,CAAec,IAAf,CAAoBC,KAApB,CAA0BF,MAA1B;IACD;;IACD,OAAOJ,KAAP;EACD;;EAEDO,KAAK,CAACP,KAAD,EAAwB;IAC3BC,OAAO,CAACC,GAAR,CAAY,6BAAZ;IACA,MAAMM,SAAS,GAAGR,KAAK,CAACA,KAAxB;IACA,MAAMS,UAAU,GAAGT,KAAK,CAACS,UAAzB;;IAEA,IAAI,KAAKN,aAAL,EAAJ,EAA0B;MACxBF,OAAO,CAACC,GAAR,CAAY,iBAAZ;MACA,KAAKX,SAAL,CAAegB,KAAf,CAAqBC,SAArB,EAAgCC,UAAhC;IACD;;IACD,OAAOT,KAAP;EACD;;EAEDU,MAAM,CAACV,KAAD,EAAyB;IAC7BC,OAAO,CAACC,GAAR,CAAY,8BAAZ;;IACA,IAAI,KAAKC,aAAL,EAAJ,EAA0B;MACxBF,OAAO,CAACC,GAAR,CAAY,kBAAZ;MACA,MAAMS,IAAI,GAAGX,KAAK,CAACW,IAAnB;MACA,MAAMF,UAAU,GAAGT,KAAK,CAACS,UAAzB;MACA,KAAKlB,SAAL,CAAemB,MAAf,CAAsBC,IAAtB,EAA4BF,UAA5B;IACD;;IACD,OAAOT,KAAP;EACD;;EAEDY,KAAK,GAAS;IACZX,OAAO,CAACC,GAAR,CAAY,6BAAZ;;IACA,IAAI,KAAKC,aAAL,EAAJ,EAA0B;MACxBF,OAAO,CAACC,GAAR,CAAY,iBAAZ;MACA,KAAKX,SAAL,CAAec,IAAf,CAAoBQ,MAApB;IACD;EACF;;AA5DoD"}